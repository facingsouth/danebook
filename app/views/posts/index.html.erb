<%= render partial: "shared/cover", locals: {user: @user} %>

<main class="container">
  <div class="row">
    <div class="col-sm-4">
      <%= render partial: "about_me" %>
      <%= render partial: "photos" %>
      <%= render partial: "friends" %>
    </div>

    <div class="col-sm-7 col-sm-offset-1">
      <% if current_user == @user %>
        <article class="row newpost-box">
          <div class="col-sm-12 box-title">
            <h5> Post </h5>
          </div>
          <%= form_for @post, class: "form-group" do |post_fields| %>
            <%= post_fields.hidden_field :user_id, value: @user.id %>
            <div class="col-sm-12">
              <%= post_fields.text_area :body, 
                                         placeholder: "Share Your Thoughts",
                                         class: "form-control" %>
            </div>
            <div class="col-sm-12 submit-bar">
              <%= hidden_field_tag :user_id, @user.id %>
              <%= post_fields.submit "Post", class: "btn btn-primary pull-right" %>
            </div>
          <% end %>
        </article>
      <% end %>

      <% @posts.each do |post| %>
        <article class ="row post">
          <div class="col-sm-2 posted-by">
            <img src="https://www.blastr.com/sites/blastr/files/styles/blog_post_media/public/dawn_apes_caesar.jpg?itok=-jHgIwlD">
          </div>
          <div class="col-sm-10 posted-name">
            <div class="col-sm-12">
              <p><%= @user.profile.full_name %><br>Posted on <%= post.created_at.to_date %></p>
            </div>
            <div class="col-sm-12">
              <p class="post-text">
                <%= post.body %>
              </p>
            </div>

          </div>

          <div class="col-sm-12 like-bar">
            <div class="col-sm-1 ">
              <% if current_user.like?(post.id, "Post") %>
                <%= link_to "Unlike", like_path(current_user.get_like_id(post.id, "Post")), 
                                    method: :delete %>
              <% else %>
                <%= link_to "Like", likes_path(user_id: current_user.id,
                                              likable_id: post.id,
                                              likable_type: "Post"), 
                                    method: :post %>
              <% end %>
            </div>
            <div class="col-sm-1">
              <a href="#">Comment</a>
            </div>
            <% if current_user == @user %>
              <div class="col-sm-1 col-sm-offset-8">
                <%= link_to "Delete", post_path(post.id, user_id: current_user.id), method: :delete %>
              </div>
            <% end %>
          </div>

          <div class="col-sm-12">
            <%= Like.display_likes_msg(post) %>
          </div>
          <%= render partial: "comments/comments", locals: {post: post} %>
        </article>
      <% end %>

    </div>

  </div>
</main>
